(()=>{var t={228:t=>{t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}},646:(t,e,n)=>{var r=n(228);t.exports=function(t){if(Array.isArray(t))return r(t)}},575:t=>{t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},913:t=>{function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}},713:t=>{t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},860:t=>{t.exports=function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}},206:t=>{t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},319:(t,e,n)=>{var r=n(646),o=n(860),i=n(379),u=n(206);t.exports=function(t){return r(t)||o(t)||i(t)||u()}},379:(t,e,n)=>{var r=n(228);t.exports=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}},458:()=>{"use strict";!function(){var t=function(){if("function"==typeof window.CustomEvent)return window.CustomEvent;function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n}return t.prototype=window.Event.prototype,t}();function e(t,e){var n=document.createElement("input");return n.type="hidden",n.name=t,n.value=e,n}function n(t){var n=t.getAttribute("data-to"),r=e("_method",t.getAttribute("data-method")),o=e("_csrf_token",t.getAttribute("data-csrf")),i=document.createElement("form"),u=t.getAttribute("target");i.method="get"===t.getAttribute("data-method")?"get":"post",i.action=n,i.style.display="hidden",u&&(i.target=u),i.appendChild(o),i.appendChild(r),document.body.appendChild(i),i.submit()}window.addEventListener("click",(function(e){for(var r=e.target;r&&r.getAttribute;){var o=new t("phoenix.link.click",{bubbles:!0,cancelable:!0});if(!r.dispatchEvent(o))return e.preventDefault(),e.stopImmediatePropagation(),!1;if(r.getAttribute("data-method"))return n(r),e.preventDefault(),!1;r=r.parentNode}}),!1),window.addEventListener("phoenix.link.click",(function(t){var e=t.target.getAttribute("data-confirm");e&&!window.confirm(e)&&t.preventDefault()}),!1)}()}},e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={exports:{}};return t[r](o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";n(458);var t=n(713),e=n.n(t),r=n(575),o=n.n(r),i=n(913),u=n.n(i),a=n(319),s=n.n(a),c=function(t){var e=t.match(/\/:[^/]*/g);return e?e.map((function(t){return t.replace("/:","")})):[]},l=function(t,e,n){if(function(t,e){return new RegExp(":".concat(e),"g").test(t)}(t,e)){var r=new RegExp(":".concat(e),"g");return t.replace(r,n)}return t},f=function(t,e){return Object.keys(e).reduce((function(n,r){return-1===t.indexOf(r)&&(n[r]=e[r]),n}),{})},p=function(t,e){return Object.keys(e).reduce((function(n,r){return n[r]=t[r]||e[r],n}),t)},d=function(t,e){return Object.keys(e).sort((function(t,e){return t.length>e.length?-1:1})).reduce((function(t,n){return l(t,n,e[n])}),t)},v=function(t,e,n){var r=new URL("".concat(t).concat(e));return Object.keys(n).forEach((function(t){r.searchParams.set(t,n[t])})),r},g=function(t,e){var n=e.template,r=e.required,o=void 0===r?[]:r,i=e.defaults,u=void 0===i?[]:i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=c(n),g=[].concat(s()(o),s()(l));if(g.every((function(t){return void 0!==a[t]}))){var h=d(n,a),m=f(l,a);m=p(m,u);var b=v(t,h,m);return b.href}var y=g.filter((function(t){return!a[t]}));throw new Error("Missing params: ".concat(y))};const h={template:"/print/:isbn",required:["from","to","token"],defaults:{locale:"en",brand:"",auto_print:!1,post_message_print:!1}},m={template:"/print/:isbn/limits",required:["token"]},b={template:"/print/:isbn/history",required:["token"],defaults:{page:1,pageSize:100}},y={template:"/print/:isbn/copies",required:["token"]},k={template:"/books/:isbn/pages/range",required:["from","to"]},w={template:"/tokens/print"},P={template:"/requests/:requestId",required:["token"]},j={template:"/requests/:requestId/claim",required:["token"],defaults:{locale:"en",brand:"",auto_print:!1,post_message_print:!1}};function O(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function q(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?O(Object(r),!0).forEach((function(n){e()(t,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var E=function(t){if(t.status>=200&&t.status<303)return Promise.resolve(204===t.status?void 0:t.json());var e=function(e){return Promise.reject({body:null==e?void 0:e.body,ok:t.ok,status:t.status,reason:t.statusText})};return t.json?t.json().then(e):e()},x=function(){function t(e){o()(this,t),this.jigsawHost=e,this.mimeoHost="https://print.vitalsource.com",this.pollInterval=5e3}return u()(t,[{key:"get",value:function(t,e,n){var r=g(t,e,n);return fetch(r).then(E)}},{key:"getPrintToken",value:function(){return this.get(this.jigsawHost,w)}},{key:"getWithToken",value:function(t,e){var n=this;return this.getPrintToken().then((function(r){var o=r.token;return n.get(n.mimeoHost,t,q({},e,{token:o}))}))}},{key:"getPrintRequest",value:function(t){return this.getWithToken(P,{requestId:t})}},{key:"getPrintUrl",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.getPrintToken().then((function(r){var o=r.token,i=q({},n,{requestId:t,token:o});return g(e.mimeoHost,j,i)}))}},{key:"createPrintRequest",value:function(t,e,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.getPrintToken().then((function(i){var u=i.token,a=q({},o,{token:u,isbn:t,from:e,to:n,async:!0});return r.get(r.mimeoHost,h,a)}))}},{key:"pollPrintRequest",value:function(t){var e=this;return this.getPrintRequest(t).then((function n(r){return e.isPrintDone(r.status)?Promise.resolve(r):function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise((function(e){return setTimeout(e,t)}))}(e.pollInterval).then((function(){return e.getPrintRequest(t)})).then(n)}))}},{key:"getPrintIframe",value:function(t,e,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.createPrintRequest(t,e,n,o).then((function(t){var e=t.requestId;return r.pollPrintRequest(e)})).then((function(t){return r.getPrintUrl(t.reqid,o)})).then((function(t){if(t){var e=document.createElement("iframe");return e.src=t,e.style="display: none;",e.setAttribute("aria-hidden",!0),e}}))}},{key:"print",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.getWithToken(h,q({},r,{isbn:t,from:e,to:n}))}},{key:"getBookLimits",value:function(t){return this.getWithToken(m,{isbn:t})}},{key:"getPrintHistory",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return this.getWithToken(b,{isbn:t,page:e,pageSize:n})}},{key:"getLifetimePages",value:function(t){return this.getWithToken(y,{isbn:t})}},{key:"getPageRange",value:function(t,e,n){return this.get(this.jigsawHost,k,{isbn:t,from:e,to:n})}},{key:"isPrintDone",value:function(t){return!["ready","printing"].includes(t)}}]),t}();window.Mimeo=x})()})();